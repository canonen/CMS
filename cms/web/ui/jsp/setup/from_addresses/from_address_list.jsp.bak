<%@ page

	language="java"
	import="com.britemoon.*,
			com.britemoon.cps.*,
			com.britemoon.cps.adm.*,
			java.io.*,java.sql.*,
			java.util.*,org.apache.log4j.*"
	errorPage="../../error_page.jsp"
	contentType="text/html;charset=UTF-8"
%>

<%@ include file="../../header.jsp" %>
<%@ include file="../../validator.jsp"%>
<%! static Logger logger = null;%>
<%
		if(logger == null)
		{
			logger = Logger.getLogger(this.getClass().getName());
		}
%>		
<HTML>

<HEAD>
	<%@ include file="../../header.html" %>
<link rel="stylesheet" href="<%=ui.s_css_filename%>" TYPE="text/css">	
<script language="JavaScript" src="/ccps/ui/ooo/script.js"></script>	
</HEAD>

<BODY class="paging_body">
<table width="100%">
	<tr>
		<td class="page_header">From Address</td>
	</tr>
</table>
<br>	

<div id="info">
<div id="xsnazzy">
<b class="xtop"><b class="xb1"></b><b class="xb2"></b><b class="xb3"></b><b class="xb4"></b></b>
<div class="xboxcontent">
<table cellspacing="0" cellpadding="3" border="0">
	<tr>
		<td align="left" valign="middle">
			<a href="from_address_edit.jsp">
			<img border="0" width="45" src="../../../images/45_45_from_adr.png" onmouseout="this.src='../../../images/45_45_from_adr.png'" onmouseover="this.src='../../images/45_45_from_adrg.png'">					
			<br>New From Address</a>&nbsp;&nbsp;&nbsp;
		</td>
	</tr>
</table>
</div>
<b class="xbottom"><b class="xb4"></b><b class="xb3"></b><b class="xb2"></b><b class="xb1"></b></b>
</div>
</div>

<br>
<table cellspacing="0" cellpadding="0" width="650" border="0">
	<tr>
		<td class="listHeading" valign="center" nowrap align="left">
		
			<br><br>

<div id="info">
<div id="xsnazzy">
<b class="xtop"><b class="xb1"></b><b class="xb2"></b><b class="xb3"></b><b class="xb4"></b></b>
<div class="xboxcontent">			
				<table class="listTable" width="100%" cellpadding="2" cellspacing="0">
				<tr>
					<th align="left" nowrap>From address</TH>
				</tr>
		<%

		ConnectionPool cp = null;
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null; 
		String sSQL = null;

		try
		{
			cp = ConnectionPool.getInstance();
			conn = cp.getConnection(this);
			stmt = conn.createStatement();

			sSQL =
				" SELECT from_address_id, prefix, domain" +
				" FROM ccps_from_address" +
				" WHERE cust_id=" + cust.s_cust_id +
				" ORDER BY prefix";

			rs = stmt.executeQuery(sSQL);

			String sFromAddressId = null;
			String sPrefix = null;
			String sDomain = null;
				
			String sClassAppend = "";
			int i = 0;

			while(rs.next())
			{
				if (i % 2 != 0)
				{
					sClassAppend = "_other";
				}
				else
				{
					sClassAppend = "";
				}
				i++;
				
				sFromAddressId = rs.getString(1);
				sPrefix = rs.getString(2);
				sDomain = rs.getString(3);
				%>
				<tbody id="Id1" onclick="location.href='from_address_edit.jsp?from_address_id=<%=sFromAddressId%>'" onmouseover="do_effect('navhover')" onmouseout="do_effect('navoff')">				
				<tr>
					<td class="list_row<%= sClassAppend %>"><a href="from_address_edit.jsp?from_address_id=<%=sFromAddressId%>"><%=sPrefix%>@<%=sDomain%></a></td>
				</tr>
				</tbody>
				<%
			}
			rs.close();
				
			if (i == 0)
			{
				%>
				<tr>
					<td class="list_row">There are currently no From Addresses</td>
				</tr>
				<%
			}
		}
		catch(Exception ex)
		{
			ex.printStackTrace(response.getWriter());
		}
		finally
		{
			if(conn!=null) cp.free(conn);
		}
		%>
			</table>
</div>
<b class="xbottom"><b class="xb4"></b><b class="xb3"></b><b class="xb2"></b><b class="xb1"></b></b>
</div>			
</div>			
		</td>
	</tr>
</table>
<br><br>
</BODY>
</HTML>
